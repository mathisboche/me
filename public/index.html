<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mathis</title>
    <link rel="icon" href="img/favicon.png" type="image/png">
    <link rel="stylesheet" href="chessboardjs-1.0.0/css/chessboard-1.0.0.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Contenu principal -->
    <div id="main-content">
        <header>
            <div class="header-content">
                <div class="image-content">
                    <img src="img/pp.png" alt="Photo de Mathis BOCHE" class="profile-photo">
                </div>
                <div class="text-content">
                    <h1>MATHIS BOCHE</h1>
                    <p class="desktop-p">Passionn√© par les √©checs, le tennis et l'IA</p>
                    <p class="mobile-p">Passionn√© par les √©checs,<br>le tennis et l'IA</p>
                </div>
            </div>
            <a href="#about" class="scroll-indicator">
                &#x25BC; <!-- Unicode character for downwards arrow -->
            </a>
        </header>
    </div>
    
    <!-- Effet de luminescence -->
    <div id="luminescence"></div>
    
    <!-- Section √† propos avec la chronologie -->
    <section id="about">
        <h2 class="section-title">Mon Parcours</h2>
        <div class="timeline">
            <div class="timeline-item" data-year="2007">
                <h3>Naissance <span class="emoji">üë∂</span></h3>
                <p>Je suis n√© le 17 ao√ªt 2007 √† F√©camp.</p>
            </div>
            <div class="timeline-item" data-year="2011">
                <h3>Commencement du Tennis <span class="emoji">üéæ</span></h3>
                <p>D√©but du tennis √† l'√¢ge de 4 ans, d√©but d'une passion pour le sport.</p>
            </div>
            <div class="timeline-item" data-year="2018">
                <h3>Pic Tennis et D√©couverte des √âchecs <span class="emoji">‚ôüÔ∏è</span></h3>
                <p>Classement 15/4 en tennis et entra√Ænement avec la ligue de Normandie. D√©couverte des √©checs et premier tournoi.</p>
            </div>
            <div class="timeline-item" data-year="2019">
                <h3>D√©m√©nagement √† Paris <span class="emoji">üèôÔ∏è</span></h3>
                <p>Arriv√©e sur Paris, continuation du tennis et adh√©sion √† un club d'√©checs en √éle-de-France.</p>
            </div>
            <div class="timeline-item" data-year="2020">
                <h3>Confinement Covid et Retour en Normandie <span class="emoji">ü¶ä</span></h3>
                <p>Pratique des √©checs √† distance durant le confinement. Anecdote personnelle : un jeune renardeau sauvage devenait un visiteur fr√©quent dans notre jardin en Normandie.</p>
            </div>
            <div class="timeline-item" data-year="2021">
                <h3>Championnat de France Jeunes U14 (√âchecs) <span class="emoji">üèÜ</span></h3>
                <p>Participation aux championnats de France jeunes U14 en √©checs.</p>
            </div>
            <div class="timeline-item" data-year="2022">
                <h3>Championnat de France Jeunes U16 (√âchecs) <span class="emoji">ü§ñ</span></h3>
                <p>Participation au championnat de France jeunes U16 en √©checs. D√©couverte de l'intelligence artificielle.</p>
            </div>
            <div class="timeline-item" data-year="2023">
                <h3>Sortie de GPT-4 <span class="emoji">üöÄ</span></h3>
                <p>Poursuite de l'int√©r√™t pour l'intelligence artificielle avec la sortie de GPT-4.</p>
            </div>
            <div class="timeline-item" data-year="2024">
                <h3>Pr√©sent <span class="emoji">üéâ</span></h3>
                <p>16 ans, passionn√© par l'IA, les √©checs et le tennis.</p>
            </div>
        </div>
    </section>    
    <!-- Section Passions -->
    <section id="passions">
        <h2 class="section-title">Mes Passions</h2>
        <div class="passion" id="echecs">
            <h3>√âchecs</h3>
            <p class="intro-paragraph">J'ai commenc√© les √©checs dans un petit club en Normandie et particip√© deux fois aux championnats de France jeunes.</p>
            <div class="chess-controls">
                <h4>Mon ouverture avec les</h4>
                <div class="toggle-switch">
                    <input type="radio" id="selectWhite" name="color" value="white" checked>
                    <label for="selectWhite">Blancs</label>
                    <input type="radio" id="selectBlack" name="color" value="black">
                    <label for="selectBlack">Noirs</label>
                    <div class="slider"></div>
                </div>
            </div>           
            <div id="chessboard" class="chess-board"></div>
            <div class="chess-summary">
                <p id="openingName" class="hidden">&nbsp;</p> <!-- Utilisation de l'espace ins√©cable pour r√©server l'espace -->
            </div>
            <div class="elo-title-container">
                <p class="elo-title">Mes √âlos :</p>
            </div>
            <div class="elo-ratings">
                <div class="elo-card">
                    <div class="emoji">üê¢</div>
                    <p><strong>Standard</strong></p>
                    <p><span id="standardElo">...</span></p>
                </div>
                <div class="elo-card">
                    <div class="emoji">üêá</div>
                    <p><strong>Rapide</strong></p>
                    <p><span id="rapidElo">...</span></p>
                </div>
                <div class="elo-card">
                    <div class="emoji">üî•</div>
                    <p><strong>Blitz</strong></p>
                    <p><span id="blitzElo">...</span></p>
                </div>
            </div>
            <a href="https://ratings.fide.com/profile/651010240" target="_blank" class="fide-link">Voir ma fiche FIDE</a>  
        </div>
    </section>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="chessboardjs-1.0.0/js/chessboard-1.0.0.min.js"></script>
    <script type="module">
        import { Chess } from 'https://cdn.jsdelivr.net/npm/chess.js@0.13.1/chess.js';

        document.addEventListener("DOMContentLoaded", function() {
            const luminescence = document.getElementById("luminescence");
    
            // Fonction pour v√©rifier si l'appareil est mobile
            function isMobileDevice() {
                return (typeof window.orientation !== "undefined") || (navigator.userAgent.indexOf('IEMobile') !== -1);
            }
            
            // Fonction pour g√©rer l'effet de luminescence
            function handleLuminescence(e) {
                if (!isMobileDevice()) {
                    luminescence.style.left = e.clientX + "px";
                    luminescence.style.top = e.clientY + "px";
                    luminescence.style.display = "block";
                } else {
                    luminescence.style.display = "none";
                }
            }
            
            // Ajouter l'√©couteur d'√©v√©nement uniquement si ce n'est pas un appareil mobile
            if (!isMobileDevice()) {
                document.addEventListener("mousemove", handleLuminescence);
            } else {
                luminescence.style.display = "none";
            }

            // R√©cup√©rer tous les √©l√©ments de la timeline et les cartes d'√©lo
            const timelineItems = document.querySelectorAll(".timeline-item");
            const eloCards = document.querySelectorAll(".elo-card");

            // Fonction pour v√©rifier si un √©l√©ment est dans le viewport
            const isInViewport = (elem) => {
                const bounding = elem.getBoundingClientRect();
                return (
                    bounding.top >= 0 &&
                    bounding.left >= 0 &&
                    bounding.bottom <= (window.innerHeight || document.documentElement.clientHeight) &&
                    bounding.right <= (window.innerWidth || document.documentElement.clientWidth)
                );
            };

            // Fonction pour ajouter la classe is-visible si l'√©l√©ment est dans le viewport
            const run = () => {
                timelineItems.forEach((item) => {
                    if (isInViewport(item)) {
                        item.classList.add("is-visible");
                    }
                });

                eloCards.forEach((card) => {
                    if (isInViewport(card)) {
                        card.classList.add("is-visible");
                    }
                });
            };

            // Ajouter des √©v√©nements pour v√©rifier le viewport au chargement, redimensionnement et d√©filement
            window.addEventListener("load", run);
            window.addEventListener("resize", run);
            window.addEventListener("scroll", run);

            // Darken background and other timeline items on hover
            timelineItems.forEach(item => {
                item.addEventListener("mouseenter", () => {
                    document.body.classList.add("darken-background");
                    timelineItems.forEach(i => {
                        if (i !== item) {
                            i.classList.add("darken");
                        }
                    });
                });
                item.addEventListener("mouseleave", () => {
                    document.body.classList.remove("darken-background");
                    timelineItems.forEach(i => {
                        i.classList.remove("darken");
                    });
                });
            });

            // JavaScript pour le plateau d'√©checs interactif
            var chessBoard = document.getElementById('chessboard');
            var chessInitialized = false;

            var observer = new IntersectionObserver(function(entries) {
                entries.forEach(function(entry) {
                    if (entry.isIntersecting && !chessInitialized) {
                        chessInitialized = true; // Emp√™che l'initialisation multiple

                        // Initialisation du plateau d'√©checs
                        var board = Chessboard('chessboard', {
                            position: 'start',
                            pieceTheme: 'img/chesspieces/wikipedia/{piece}.png'
                        });

                        var game = new Chess();

                        var londonSystemMoves = [
                            'd4', 'Nf6',
                            'Nf3', 'g6',
                            'Bf4', 'Bg7',
                            'e3', 'O-O',
                            'Be2', 'd6',
                            'h3', 'c5',
                            'c3', 'b6',
                            'O-O'
                        ];

                        var sicilianDefenseMoves = [
                            'e4', 'c5',
                            'Nf3', 'Nc6',
                            'd4', 'cxd4',
                            'Nxd4', 'd6',
                            'Nc3', 'Nf6',
                            'f3', 'e6',
                            'Be3', 'Be7',
                            'Qd2', 'O-O',
                            'O-O-O', 'a6',
                            'g4', 'Nxd4',
                            'Bxd4', 'b5'
                        ];

                        var currentMoves = [];
                        var currentIndex = 0;
                        var moveTimeout;

                        function makeNextMove() {
                            if (currentIndex >= currentMoves.length) return;
                            game.move(currentMoves[currentIndex]);
                            board.position(game.fen());
                            currentIndex++;
                            moveTimeout = setTimeout(makeNextMove, 1000);
                        }

                        function resetBoard(orientation) {
                            clearTimeout(moveTimeout);
                            board.orientation(orientation);
                            board.start();
                            game.reset();
                            currentIndex = 0;
                        }

                        function showOpeningName(name) {
                            var openingNameElement = document.getElementById('openingName');
                            openingNameElement.innerText = name;
                            openingNameElement.classList.remove('hidden');
                        }

                        // Commence le Syst√®me de Londres lorsque l'√©l√©ment entre dans la vue
                        resetBoard('white');
                        currentMoves = londonSystemMoves;
                        showOpeningName('Syst√®me de Londres');
                        setTimeout(makeNextMove, 1000);

                        // Configuration des √©v√©nements pour les boutons
                        document.getElementById('selectWhite').addEventListener('change', function() {
                            if (this.checked) {
                                resetBoard('white');
                                currentMoves = londonSystemMoves;
                                showOpeningName('Syst√®me de Londres');
                                setTimeout(makeNextMove, 1000);
                            }
                        });

                        document.getElementById('selectBlack').addEventListener('change', function() {
                            if (this.checked) {
                                resetBoard('black');
                                currentMoves = sicilianDefenseMoves;
                                showOpeningName('D√©fense Sicilienne');
                                setTimeout(makeNextMove, 1000);
                            }
                        });
                    }
                });
            }, { threshold: 1.0 }); // Ajustez ce seuil selon vos besoins

            observer.observe(chessBoard);
        });
    </script>
    <script>
        async function fetchElos() {
          try {
            const response = await fetch('/api/get_fide_ratings');
            const data = await response.json();
            document.getElementById('standardElo').innerText = `${data.standard} F`;
            document.getElementById('rapidElo').innerText = `${data.rapid} F`;
            document.getElementById('blitzElo').innerText = `${data.blitz} F`;
          } catch (error) {
            console.error('Erreur lors de la r√©cup√©ration des √âlos:', error);
          }
        }
      
        document.addEventListener('DOMContentLoaded', fetchElos);
      </script>
      <script>
        document.querySelector('.scroll-indicator').addEventListener('click', function(e) {
            e.preventDefault();
            document.querySelector('#about').scrollIntoView({ behavior: 'smooth' });
        });
    </script>    
</body>
</html>